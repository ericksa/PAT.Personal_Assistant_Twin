services:  # ----------------------------  # PostgreSQL + pgvector  # ----------------------------  postgres:    image: pgvector/pgvector:pg17    container_name: pgvector    restart: unless-stopped    environment:      POSTGRES_DB: ${POSTGRES_DB}      POSTGRES_USER: ${POSTGRES_USER}      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}    volumes:      - .scripts/init.sql:/docker-entrypoint-initdb.d/init.sql      - pgdata:/var/lib/postgresql/data    ports:      - "5432:5432"    healthcheck:      test: ["CMD-SHELL", "pg_isready -U llm"]      interval: 10s      timeout: 5s      retries: 5  # ----------------------------  # Redis (cache, agent memory)  # ----------------------------  redis:    image: redis:7    container_name: redis    restart: unless-stopped    command: redis-server --save 60 1 --loglevel warning    ports:      - "6379:6379"    volumes:      - redisdata:/data  # ----------------------------  # n8n (workflow orchestration)  # ----------------------------  n8n:    image: n8nio/n8n:latest    container_name: n8n    restart: unless-stopped    ports:      - "5678:5678"    environment:      N8N_BASIC_AUTH_ACTIVE: "true"      N8N_BASIC_AUTH_USER: ${N8N_BASIC_AUTH_USER}      N8N_BASIC_AUTH_PASSWORD: ${N8N_BASIC_AUTH_PASSWORD}      N8N_HOST: localhost      N8N_PORT: 5678      N8N_PROTOCOL: http      WEBHOOK_URL: http://localhost:5678/      GENERIC_TIMEZONE: America/New_York    volumes:      - n8ndata:/home/node/.n8n    depends_on:      - postgres  # ----------------------------  # MinIO (Object Storage)  # ----------------------------  minio:    image: minio/minio:latest    container_name: minio    restart: unless-stopped    environment:      MINIO_ROOT_USER: ${MINIO_ROOT_USER}      MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD}    command: server /data --console-address ":9001"    ports:      - "9000:9000"  # S3 API      - "9001:9001"  # Console UI    volumes:      - miniodata:/data  # ----------------------------  # Ingest Service  # ----------------------------  ingest-service:    build: ./services/ingest    container_name: ingest-service    restart: unless-stopped    environment:      HUGGINGFACE_HUB_TOKEN: ${HUGGINGFACE_HUB_TOKEN}      DATABASE_URL: postgresql://llm:llm@postgres:5432/llm      REDIS_URL: redis://redis:6379/0      MINIO_URL: http://minio:9000      MINIO_ACCESS_KEY: ${MINIO_ACCESS_KEY}      MINIO_SECRET_KEY: ${MINIO_SECRET_KEY}      EMBEDDING_MODEL: BAAI/bge-base-en-v1.5      CHUNK_SIZE: 800      CHUNK_OVERLAP: 120      OLLAMA_BASE_URL: http://host.docker.internal:11434      OLLAMA_EMBEDDING_MODEL: nomic-embed-text    depends_on:      postgres:        condition: service_healthy      redis:        condition: service_started      minio:        condition: service_started    volumes:      - ./data/uploads:/data/uploads       # Temp dev storage      - ./data/documents:/data/documents   # Permanent ingestion storage      - ./data/models:/data/models         # Local models    ports:      - "8001:8000"  # ----------------------------  # Agent / RAG Service  # ----------------------------  agent-service:    build: ./services/agent    container_name: agent-service    restart: unless-stopped    environment:      DATABASE_URL: postgresql://llm:llm@postgres:5432/llm      REDIS_URL: redis://redis:6379/0      # LLM routing      LLM_PROVIDER: ollama # mlx          ollama      OLLAMA_BASE_URL: http://host.docker.internal:11434      OLLAMA_EMBEDDING_MODEL: nomic-embed-text      # RAG      TOP_K: 5      SCORE_THRESHOLD: 0.2    depends_on:      postgres:        condition: service_healthy      redis:        condition: service_started    volumes:      - ./data/models:/data/models         # Local LLM models      - ./data/documents:/data/documents   # Access to stored docs      - ./data/data:/data/data             # Any metadata or additional structured data      - ./data/docs:/data/docs             # Documentation files    ports:      - "8002:8000"volumes:  pgdata:  redisdata:  n8ndata:  miniodata: